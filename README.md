# Генератор маршрутных карт по ГОСТ 3.1118

Программное обеспечение для автоматического формирования маршрутных карт в соответствии с ГОСТ 3.1118.

## Описание проблемы

Оформление маршрутных карт вручную в MS Word:
- **Трудоемко**: ~100 чел/ч на печатный узел с 500 элементами (~30 листов А4)
- **Рискованно**: возможны ошибки и пропуски элементов
- **Неудобно**: сложность работы с рамками и таблицами

## Решение

Автоматизированная система, которая:
- ✅ Загружает данные из Excel и текстовых файлов
- ✅ Автоматически формирует маршрутную карту по ГОСТ 3.1118
- ✅ Поддерживает редактирование данных
- ✅ Экспортирует в DOCX и PDF
- ✅ Обеспечивает предпросмотр перед сохранением

## Установка

### Требования
- Python 3.8+
- Windows/Linux/macOS

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Содержимое requirements.txt

```
pandas>=1.3.0
openpyxl>=3.0.0
python-docx>=0.8.11
reportlab>=3.6.0
```

Опционально для конвертации в PDF на Windows:
```
docx2pdf>=0.1.8
```

## Запуск

```bash
python main.py
```

## Использование

### 1. Подготовка входных данных

#### Elements.xlsx
Файл Excel с информацией об элементах:

| Designator | Description | Quantity | ... |
|------------|-------------|----------|-----|
| C1 | Конденсатор 100нФ | 1 | ... |
| R1 | Резистор 10кОм | 1 | ... |
| U1 | Микросхема ATmega328 | 1 | ... |

#### Proc.txt
Текстовый файл с описанием процессов:

```
Operation: Монтаж компонентов
Equipment: Паяльная станция
...
```

### 2. Работа с программой

1. **Загрузка данных**
   - Нажмите "📂 Загрузить Elements.xlsx"
   - Нажмите "📂 Загрузить Proc.txt"

2. **Редактирование** (опционально)
   - Выберите строку в таблице
   - Нажмите "✏️ Редактировать" или дважды кликните
   - Используйте "➕ Добавить строку" или "🗑️ Удалить строку"

3. **Предпросмотр**
   - Нажмите "👁️ Предпросмотр"
   - Проверьте данные
   - При необходимости откройте в Word

4. **Генерация документа**
   - Нажмите "📄 Сохранить DOCX"
   - Введите информацию о документе:
     - Наименование изделия
     - Обозначение
     - Разработчик
     - Дата
   - Выберите место сохранения

5. **Экспорт в PDF** (опционально)
   - Нажмите "📑 Экспорт в PDF"
   - Введите информацию о документе
   - Выберите место сохранения

## Структура проекта

```
route-card-generator/
├── main.py                 # Главный модуль приложения
├── data_processor.py       # Обработка данных
├── document_generator.py   # Генерация документов по ГОСТ
├── preview_window.py       # Окно предпросмотра
├── edit_dialog.py          # Диалог редактирования
├── requirements.txt        # Зависимости
├── README.md              # Документация
├── GOST_COMPLIANCE.md     # Соответствие ГОСТ
└── task.md                # Постановка задачи
```

## Соответствие ГОСТ 3.1118

### Реализовано:
- ✅ Форма 4 (первый лист)
- ✅ Форма 3б (последующие листы)
- ✅ Типы строк (О - операция, Т - переход)
- ✅ Информационная рамка
- ✅ Нумерация строк с префиксами
- ✅ Автоматическое разбиение на страницы

### Структура таблицы:
| Тип | № | Наименование | Оборудование | Материал | Тп.з | Тшт |
|-----|---|--------------|--------------|----------|------|-----|

Подробнее см. [GOST_COMPLIANCE.md](GOST_COMPLIANCE.md)

## Примеры

### Пример 1: Простая маршрутная карта

**Входные данные (Elements.xlsx):**
```
Designator | Description        | Quantity
C1         | Конденсатор 100нФ  | 1
R1         | Резистор 10кОм     | 1
```

**Выходной документ:**
```
МАРШРУТНАЯ КАРТА

Наименование изделия: Печатный узел
Обозначение: ПУ-001
Лист: 1

┌────┬─────┬────────────────────────┬────────────┬──────────┬──────┬──────┐
│Тип │  №  │   Наименование         │Оборудование│Материал  │ Тп.з │ Тшт  │
├────┼─────┼────────────────────────┼────────────┼──────────┼──────┼──────┤
│ О  │ О01 │ Монтаж                 │            │          │      │      │
│ Т  │ Т02 │ C1 - Конденсатор 100нФ │            │          │      │  1   │
│ Т  │ Т03 │ R1 - Резистор 10кОм    │            │          │      │  1   │
└────┴─────┴────────────────────────┴────────────┴──────────┴──────┴──────┘
```

## Преимущества

### До автоматизации:
- ⏱️ ~100 чел/ч на 500 элементов
- ❌ Риск ошибок и пропусков
- 📝 Ручное оформление в Word
- 🔄 Сложность внесения изменений

### После автоматизации:
- ⚡ ~5 минут на любое количество элементов
- ✅ Автоматическая проверка полноты
- 🤖 Автоматическое форматирование
- 🔄 Простое редактирование и обновление

### Экономия:
- **Время**: с 100 часов до 5 минут (экономия 99.9%)
- **Качество**: исключение человеческих ошибок
- **Гибкость**: быстрое внесение изменений

## Ограничения

1. **Упрощенная информационная рамка** - не все поля ГОСТ реализованы
2. **Автоматический расчет времени** - требует дополнительных данных
3. **Типы строк** - реализованы основные (О, Т), остальные требуют доработки

## Дальнейшее развитие

### Планируемые улучшения:
1. Полная реализация всех полей ГОСТ 3.1118
2. Библиотека типовых операций
3. Автоматический расчет норм времени
4. Интеграция с ERP-системами
5. Поддержка шаблонов документов
6. Экспорт в другие форматы (HTML, XML)

## Техническая поддержка

При возникновении проблем:
1. Проверьте формат входных файлов
2. Убедитесь, что установлены все зависимости
3. Проверьте логи ошибок

## Лицензия

Разработано для АО «НПК «СПП»

## Авторы

Проект разработан в рамках задачи автоматизации оформления конструкторской документации.

---

**Версия:** 2.0  
**Дата:** Декабрь 2024  
**Статус:** Базовая реализация ГОСТ 3.1118
